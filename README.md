# Novel_v3 - ç°ä»£åŒ–å°è¯´é˜…è¯»å¹³å°

åŸºäº Legado ä¹¦æºçš„å…¨æ ˆå°è¯´é˜…è¯»ç½‘ç«™ï¼Œæä¾›æµç•…çš„åœ¨çº¿é˜…è¯»ä½“éªŒå’Œä¹¦ç±ç®¡ç†åŠŸèƒ½ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ğŸ“š **ä¹¦æºç®¡ç†**ï¼šæ”¯æŒå¯¼å…¥å’Œç®¡ç† Legado ä¹¦æºï¼ˆJSON/URLï¼‰
- ğŸ” **å…¨å±€æœç´¢**ï¼šè·¨æ‰€æœ‰ä¹¦æºæœç´¢å°è¯´
- ğŸ“– **åœ¨çº¿é˜…è¯»**ï¼šæµç•…çš„ç« èŠ‚é˜…è¯»ä½“éªŒ
- ğŸ’¾ **ä¹¦åº“ç®¡ç†**ï¼šæ”¶è—å–œæ¬¢çš„å°è¯´ï¼Œæ”¯æŒä¸‹è½½åˆ°æœåŠ¡å™¨
- ğŸ¨ **ç°ä»£ç•Œé¢**ï¼šå“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ·±è‰²/æµ…è‰²ä¸»é¢˜
- ğŸš€ **é«˜æ€§èƒ½**ï¼šå¼‚æ­¥å¤„ç†ï¼Œå¿«é€Ÿå“åº”

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**ï¼šReact 18 + TypeScript
- **æ„å»ºå·¥å…·**ï¼šVite
- **æ ·å¼**ï¼šTailwind CSS
- **è·¯ç”±**ï¼šReact Router v6
- **çŠ¶æ€ç®¡ç†**ï¼šZustand
- **HTTP å®¢æˆ·ç«¯**ï¼šAxios

### åç«¯
- **æ¡†æ¶**ï¼šFastAPI (Python)
- **æ•°æ®åº“**ï¼šSQLite + SQLAlchemy
- **ä¹¦æºè§£æ**ï¼šLegadoParser2
- **å¼‚æ­¥æ”¯æŒ**ï¼šaiosqlite

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
Novel_v3/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ book_sources.py    # ä¹¦æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ search.py          # æœç´¢åŠŸèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ books.py           # ä¹¦ç±ä¿¡æ¯
â”‚   â”‚   â”‚   â”œâ”€â”€ library.py         # ä¹¦åº“ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ explore.py         # å‘ç°é¡µé¢
â”‚   â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ schemas/           # Pydantic æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ database.py        # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ config.py          # åº”ç”¨é…ç½®
â”‚   â”‚   â””â”€â”€ main.py            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ downloads/             # ä¸‹è½½çš„ä¹¦ç±
â”‚   â”œâ”€â”€ novel.db               # SQLite æ•°æ®åº“
â”‚   â””â”€â”€ requirements.txt       # Python ä¾èµ–
â”‚
â”œâ”€â”€ frontend/                   # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.tsx           # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ BookSources.tsx    # ä¹¦æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ BookDetail.tsx     # ä¹¦ç±è¯¦æƒ…
â”‚   â”‚   â”‚   â”œâ”€â”€ Library.tsx        # æˆ‘çš„ä¹¦åº“
â”‚   â”‚   â”‚   â””â”€â”€ Reader.tsx         # é˜…è¯»å™¨
â”‚   â”‚   â”œâ”€â”€ components/        # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/          # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ stores/            # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ types/             # TypeScript ç±»å‹
â”‚   â”‚   â””â”€â”€ App.tsx            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”‚
â””â”€â”€ LegadoParser/              # ä¹¦æºè§£æå™¨ï¼ˆç¬¬ä¸‰æ–¹ï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.9+
- **Node.js**: 16+
- **npm**: 8+

### æœ¬åœ°å¼€å‘

#### 1. å¯åŠ¨åç«¯

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

åç«¯æœåŠ¡è¿è¡Œåœ¨ï¼š`http://localhost:8000`
API æ–‡æ¡£ï¼š`http://localhost:8000/docs`

#### 2. å¯åŠ¨å‰ç«¯

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

å‰ç«¯åº”ç”¨è¿è¡Œåœ¨ï¼š`http://localhost:5173`

### ç”Ÿäº§éƒ¨ç½²

#### åç«¯éƒ¨ç½²

```bash
# 1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
scp -r backend root@your-server:/var/www/novel/

# 2. SSH è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server

# 3. å®‰è£…ä¾èµ–
cd /var/www/novel/backend
pip install -r requirements.txt

# 4. å¯åŠ¨æœåŠ¡ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000

# 5. å¼€æ”¾ç«¯å£
sudo ufw allow 8000
```

#### å‰ç«¯éƒ¨ç½²

```bash
# 1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
scp -r frontend root@your-server:/var/www/novel/

# 2. SSH è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server

# 3. å®‰è£…ä¾èµ–
cd /var/www/novel/frontend
npm install

# 4. å¯åŠ¨æœåŠ¡
npm run dev -- --host 0.0.0.0

# 5. å¼€æ”¾ç«¯å£
sudo ufw allow 5173
```

**è®¿é—®åœ°å€**ï¼š
- å‰ç«¯ï¼š`http://your-server-ip:5173`
- åç«¯ APIï¼š`http://your-server-ip:8000`

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. æ·»åŠ ä¹¦æº

**æ–¹å¼ä¸€ï¼šJSON æ–‡æœ¬**
1. è¿›å…¥"ä¹¦æºç®¡ç†"é¡µé¢
2. ç‚¹å‡»"æ·»åŠ ä¹¦æº"
3. é€‰æ‹©"JSON æ–‡æœ¬"
4. ç²˜è´´ä¹¦æº JSON
5. ç‚¹å‡»"æ·»åŠ "

**æ–¹å¼äºŒï¼šç½‘ç»œé“¾æ¥**
1. è¿›å…¥"ä¹¦æºç®¡ç†"é¡µé¢
2. ç‚¹å‡»"æ·»åŠ ä¹¦æº"
3. é€‰æ‹©"ç½‘ç»œé“¾æ¥"
4. è¾“å…¥ä¹¦æº URL
5. ç‚¹å‡»"æ·»åŠ "

**æ¨èä¹¦æº**ï¼šç¬”è¶£é˜ï¼ˆç®€å•è§„åˆ™ï¼Œå…¼å®¹æ€§å¥½ï¼‰

### 2. æœç´¢å°è¯´

- **é¦–é¡µæœç´¢**ï¼šè·¨æ‰€æœ‰ä¹¦æºæœç´¢
- **ä¹¦æºæœç´¢**ï¼šåœ¨æŒ‡å®šä¹¦æºä¸­æœç´¢

### 3. é˜…è¯»å’Œç®¡ç†

1. ç‚¹å‡»æœç´¢ç»“æœæŸ¥çœ‹ä¹¦ç±è¯¦æƒ…
2. ç‚¹å‡»"æ”¶è—"æ·»åŠ åˆ°ä¹¦åº“
3. ç‚¹å‡»"ä¸‹è½½åˆ°æœåŠ¡å™¨"ç¦»çº¿ä¿å­˜
4. ç‚¹å‡»ç« èŠ‚å¼€å§‹é˜…è¯»

## âš ï¸ ä¹¦æºå…¼å®¹æ€§è¯´æ˜

### âœ… æ”¯æŒçš„è§„åˆ™
- CSS é€‰æ‹©å™¨ï¼š`.item`, `h3 a@text`
- XPathï¼š`//div[@class='book']`
- JSONPathï¼š`$.data.list[*]`
- æ­£åˆ™è¡¨è¾¾å¼

### âŒ ä¸æ”¯æŒçš„è§„åˆ™
- Legado APP ä¸“æœ‰ APIï¼ˆ`java.ajax()`, `java.base64Encode()` ç­‰ï¼‰
- å¤æ‚çš„ JavaScript ä»£ç 

**æ¨è**ï¼šä½¿ç”¨ç±»ä¼¼ç¬”è¶£é˜çš„ç®€å•è§„åˆ™ä¹¦æºã€‚

## ğŸ”§ API æ¥å£

### ä¸»è¦ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/v1/book-sources` | GET/POST | ä¹¦æºç®¡ç† |
| `/api/v1/search` | GET | å…¨å±€æœç´¢ |
| `/api/v1/books/{book_url}/info` | GET | ä¹¦ç±ä¿¡æ¯ |
| `/api/v1/books/chapters` | GET | ç« èŠ‚åˆ—è¡¨ |
| `/api/v1/books/chapter/content` | GET | ç« èŠ‚å†…å®¹ |
| `/api/v1/library` | GET/POST | ä¹¦åº“ç®¡ç† |
| `/api/v1/library/{id}/download` | POST | ä¸‹è½½ä¹¦ç± |

å®Œæ•´ API æ–‡æ¡£ï¼š`http://localhost:8000/docs`

## ğŸ“ å¼€å‘è¯´æ˜

### å‰ç«¯å¼€å‘

```bash
cd frontend
npm run dev      # å¼€å‘æœåŠ¡å™¨
npm run build    # ç”Ÿäº§æ„å»º
npm run preview  # é¢„è§ˆæ„å»ºç»“æœ
npm run lint     # ä»£ç æ£€æŸ¥
```

### åç«¯å¼€å‘

```bash
cd backend
python -m uvicorn app.main:app --reload  # çƒ­é‡è½½æ¨¡å¼
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº LegadoParser å¼€å‘ï¼Œéµå¾ªå…¶å¼€æºåè®®ã€‚

